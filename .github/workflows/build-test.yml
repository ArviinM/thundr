---
   name: Build the App on Test Environment
   run-name: ${{ github.actor }} is Triggering Develop Build ðŸš€
   on:
     push:
       branches:
         - test-build
   env:
     BUILD_NAME: 1.0.0
     BUILD_NUMBER: ${{github.run_number}}
     APP_NAME: ThundrDev
     APP_ID: ph.thundr.app.dev
   jobs:
     Git-Fetch-State:
       runs-on: self-hosted
       steps:
         - name: Check out repository code
           uses: actions/checkout@v3
           with:
            fetch-depth: 0
         - run: echo "${{ github.event.head_commit.message }}"
     Package-Rename:
       runs-on: self-hosted
       needs: Git-Fetch-State
       steps:
         - run: ls
         #- run: react-native-rename "${{ENV.APP_NAME}}" -b "${{ENV.APP_ID}}"
         - run: echo -en "${{VARS.DEV_ENV}}" >> .env
     Yarn-Install:
       runs-on: self-hosted
       needs: Package-Rename
       steps:
         - run: yarn install
         - run: ls
     Android-Prepare-Build:
       runs-on: self-hosted
       needs: Yarn-Install
       defaults:
         run:
           working-directory: ./android
       steps:
         - run: ls
         - run: echo "MYAPP_RELEASE_STORE_FILE=${{secrets.KEYSTORE_PATH}}" >>
             gradle.properties
         - run: echo "MYAPP_RELEASE_STORE_PASSWORD=${{secrets.KEYSTORE_PASSWORD}}" >>
             gradle.properties
         - run: echo "MYAPP_RELEASE_KEY_ALIAS=${{secrets.KEY_ALIAS}}" >> gradle.properties
         - run: echo "MYAPP_RELEASE_KEY_PASSWORD=${{secrets.KEY_PASSWORD}}" >>
             gradle.properties
         - run: echo "BUILD_NUMBER=${{ENV.BUILD_NUMBER}}" >> gradle.properties
         - run: echo "BUILD_NAME=${{ENV.BUILD_NAME}}" >> gradle.properties
         - run: echo "PLAY_PUBLISH_KEY_JSON=${{secrets.PLAYSTORE_JSON_KEY}}" >>
             gradle.properties
         - run: echo "PLAY_PUBLISH_TRACK=internal" >> gradle.properties
         - run: echo "RELEASE_NAME=Release ${{ENV.BUILD_NUMBER}}" >> gradle.properties
         - run: more gradle.properties
         - run: ls app
         - run: ./gradlew clean
     Android-APK-Build:
       runs-on: self-hosted
       needs: Android-Prepare-Build
       defaults:
         run:
           working-directory: ./android
       steps:
         - run: ls
         - run: ./gradlew assembleRelease
     Android-APK-Upload:
       runs-on: self-hosted
       needs: Android-APK-Build
       defaults:
         run:
           working-directory: ./android/app/build/outputs/apk/release
       steps:
         - run: ls
         - run: cp app-release.apk "thundr-dev-${{ github.run_number }}.apk"
         - run: cp "thundr-dev-${{ github.run_number }}.apk" /Users/thundr/Documents/Projects/Thundr/artifacts/
     Android-AAB-Build:
       runs-on: self-hosted
       needs: Android-Prepare-Build
       defaults:
         run:
           working-directory: ./android
       steps:
         - run: ls
         - run: ./gradlew bundleRelease
     Android-AAB-Upload:
       runs-on: self-hosted
       needs: Android-AAB-Build
       defaults:
         run:
           working-directory: ./android/app/build/outputs/bundle/release
       steps:
         - run: ls
         - run: cp app-release.aab "thundr-dev-${{ github.run_number }}.aab"
         - run: cp "thundr-dev-${{ github.run_number }}.aab" /Users/thundr/Documents/Projects/Thundr/artifacts/    
   concurrency:
     group: thundr-mobile-test
     cancel-in-progress: false
  